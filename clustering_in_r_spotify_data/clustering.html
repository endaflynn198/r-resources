<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Enda Flynn">
<meta name="dcterms.date" content="2024-07-28">

<title>Clustering in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="clustering_files/libs/clipboard/clipboard.min.js"></script>
<script src="clustering_files/libs/quarto-html/quarto.js"></script>
<script src="clustering_files/libs/quarto-html/popper.min.js"></script>
<script src="clustering_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="clustering_files/libs/quarto-html/anchor.min.js"></script>
<link href="clustering_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="clustering_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="clustering_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="clustering_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="clustering_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="clustering_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="clustering_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">

<script src="clustering_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="clustering_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="clustering_files/libs/datatables-binding-0.22/datatables.js"></script>
<script src="clustering_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="clustering_files/libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="clustering_files/libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="clustering_files/libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="clustering_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="clustering_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto">Quarto</a></li>
  </ul></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling">Scaling</a></li>
  <li><a href="#pairs-plot" id="toc-pairs-plot" class="nav-link" data-scroll-target="#pairs-plot">Pairs Plot</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing Values</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix">Correlation Matrix</a></li>
  </ul></li>
  <li><a href="#fitting-the-clustering-algorithm" id="toc-fitting-the-clustering-algorithm" class="nav-link" data-scroll-target="#fitting-the-clustering-algorithm">Fitting the Clustering Algorithm</a></li>
  <li><a href="#internal-validation" id="toc-internal-validation" class="nav-link" data-scroll-target="#internal-validation">Internal Validation</a>
  <ul class="collapse">
  <li><a href="#calinski-harabasz-index" id="toc-calinski-harabasz-index" class="nav-link" data-scroll-target="#calinski-harabasz-index">Calinski-Harabasz Index</a></li>
  <li><a href="#silhouette-plot" id="toc-silhouette-plot" class="nav-link" data-scroll-target="#silhouette-plot">Silhouette Plot</a></li>
  </ul></li>
  <li><a href="#external-validation" id="toc-external-validation" class="nav-link" data-scroll-target="#external-validation">External Validation</a>
  <ul class="collapse">
  <li><a href="#visually-comparing-clustering-to-genre-classification" id="toc-visually-comparing-clustering-to-genre-classification" class="nav-link" data-scroll-target="#visually-comparing-clustering-to-genre-classification">Visually Comparing Clustering to Genre Classification</a></li>
  <li><a href="#rand-index" id="toc-rand-index" class="nav-link" data-scroll-target="#rand-index">Rand Index</a></li>
  </ul></li>
  <li><a href="#interpreting-the-clusters" id="toc-interpreting-the-clusters" class="nav-link" data-scroll-target="#interpreting-the-clusters">Interpreting the Clusters</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Clustering in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Enda Flynn </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><em>Note that you can collapse the code using the button on the top right to focus on the analysis.</em></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<p>This analysis will focus on clustering songs based on their audio features. We will use the k-means algorithm to group songs into clusters based on their audio attributes. We will explore the data, fit the clustering algorithm, and evaluate the results using internal and external validation methods.</p>
</section>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<p>The data is extracted from <a href="https://developer.spotify.com/">Spotify</a> and includes various audio features of songs. The dataset contains information on 239 songs and their audio features, such as danceability, energy, and tempo.</p>
</section>
<section id="quarto" class="level3">
<h3 class="anchored" data-anchor-id="quarto">Quarto</h3>
<p>This analysis also demonstrates the utility of <a href="https://quarto.org/">Quarto</a> for sharing analysis and writing reports. Quarto allows for the integration of code, text, and visualizations in a single document, making it easy to create interactive and dynamic reports. We also make use of tabsets to compare different clustering solutions and visualizations.</p>
<div class="cell">

</div>
</section>
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<p>We begin by outputting a table and inspecting the data.</p>
<p>There are 239 songs (rows) and the columns are as follows:</p>
<ul>
<li><code>song_name</code>: the title of the song</li>
<li><code>artist</code>: the artist of the song</li>
<li><code>genre</code>: the genre of the song</li>
<li><code>song_popularity</code>: the popularity of the song</li>
<li><code>song_duration_ms</code>: the duration of the song in milliseconds</li>
<li><code>acousticness</code>: a measure of the song’s acousticness</li>
<li><code>danceability</code>: a measure of the song’s danceability</li>
<li><code>energy</code>: a measure of the song’s energy</li>
<li><code>liveness</code>: a measure of the song’s liveness</li>
<li><code>loudness</code>: a measure of the song’s loudness</li>
<li><code>speechiness</code>: a measure of the song’s speechiness</li>
<li><code>tempo</code>: the tempo of the song</li>
<li><code>audio_valence</code>: a measure of the song’s valence</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"data/data_spotify_songs.rda"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(spotify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-c163527b600d9dbbfeea" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c163527b600d9dbbfeea">{"x":{"filter":"none","vertical":false,"data":[["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551"],["rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","rock","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","pop","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic","acoustic"],["In The End","Seven Nation Army","By The Way","How You Remind Me","Bring Me To Life","Last Resort","Are You Gonna Be My Girl","Mr. Brightside","Sex on Fire","The Middle","Numb","Smooth Criminal","Can't Stop","Chop Suey!","Take Me Out","I Miss You","Best of You","I Write Sins Not Tragedies","Kryptonite","The Kill (Bury Me)","Use Somebody","No One Knows","Jerk It Out","Uprising","Hey There Delilah","Blurry","American Idiot","Welcome to the Black Parade","Gives You Hell","All My Life","Like a Stone","It's Been Awhile","I Hate Everything About You","Rollin' (Air Raid Vehicle)","Fat Lip","The Pretender","Savior","Bodies","Sugar, We're Goin Down","Last Nite","Through Glass","The Diary of Jane - Single Version","Down With the Sickness","Wish You Were Here","Youth Of The Nation","Vertigo","Miss Murder","I Bet You Look Good On The Dancefloor","Steady, As She Goes","Falling Away from Me","Crawling In The Dark","I Stand Alone","Woman","Show Me How to Live","The Red","Remedy","Plug In Baby","Change (In the House of Flies) - In The House Of Flies LP Version","Judith","Crazy In Love","Rock Your Body","Beautiful Girls","Toxic","Michael Jackson x Mark Ronson: Diamonds are Invincible","Yeah!","Live Your Life (feat. Rihanna)","Hips Don't Lie","Hey, Soul Sister","Pumped Up Kicks","Love Never Felt so Good","Hall of Fame","All of Me","Drops of Jupiter","We Can't Stop","Fighter","Since U Been Gone","Hey Ya! - Radio Mix / Club Mix","TiK ToK","Look At Me Now","SexyBack","With You","Breakeven","I Know You Want Me (Calle Ocho)","Bye Bye Bye","Complicated","Let Me Love You","Beautiful","Raise Your Glass","Timber","What Makes You Beautiful","No One","Sk8er Boi","Womanizer","Give Me Everything","Single Ladies (Put a Ring on It)","Bleeding Love","Lose My Breath","Love Song","Ms. Jackson","Die Young","Survivor","Oops!...I Did It Again","Cry Me a River","Get Lucky (feat. Pharrell Williams &amp; Nile Rodgers) - Radio Edit","Whatever You Like","One, Two Step","Unwritten","Wrecking Ball","So What","Whenever, Wherever","Baby Boy","It's Gonna Be Me","My Boo","Sex on Fire","Stronger (What Doesn't Kill You)","Over My Head (Cable Car)","For the First Time","Girlfriend","Fallin'","Use Somebody","How to Save a Life","Not Over You","Before He Cheats","Dirrty (feat. Redman)","Caught Up","If I Ain't Got You","Wherever You Will Go","You Found Me","Independent Women, Pt. 1","Because of You","Get The Party Started","The Anthem","I Don't Want to Be","The Way You Move (feat. Sleepy Brown) - Club Mix","Better in Time","Over You","The Great Escape","Your Body Is a Wonderland","Superman (It's Not Easy)","Perfect Duet (Ed Sheeran &amp; Beyoncé)","Shallow","Ophelia","Can’t Help Falling in Love","Beyond","Latch - Acoustic","Shrike","Big Jet Plane","When You Love Someone - Acoustic","Slow Dancing in a Burning Room - Acoustic","Georgia","Send My Love (To Your New Lover)","Wild Love - Acoustic","Foreign Hands","Smoke Filled Room - Acoustic Session","Wild Horses - Acoustic","September Song - Guitar Acoustic","Lost On You","Hold My Girl","Castle on the Hill - Acoustic","After Rain","Such A Simple Thing","You Sigh","Chemicals - Acoustic","Morning Breeze","Happier - Acoustic","Melt (Acoustic Version)","My Arms Were Always Around You","Lay It On Me - Acoustic","Little Boy","Never in My Wildest Dreams","New Rules - Acoustic","hate u love u","Dream - Acoustic","Only Love","Take Me To Church - Live From Spotify, London","For Now","Cherry Wine - Live","Honest","Honey","The Woods - Acoustic","Waves - Acoustic","Tee Shirt","Hell Or High Water","Paper Thin - Live From Studio","Moving Mountains","Another Way","Concrete Jungle - Acoustic","Where's My Love","Adore - Piano Unplugged","Hollow (Acoustic)","Jungle","Elastic Heart - Live from The Village","Most Girls - Acoustic","Sleep On The Floor","little light - acoustic version","I Will Spend My Whole Life Loving You","Best Days - Acoustic","Love on the Weekend","Acoustic","Catie Rae","Issues - Acoustic","Shape of You - Acoustic","All I Want","Boston","Girl Crush - Recorded at Metropolis Studios, London","Save My Life - Radio Edit","No Place In Mind","Tell Me - Acoustic","Let It Go - James Bay Spotify Session 2015","Cringe - Stripped","Can't See Straight - Acoustic","Young Blood - Acoustic","Better","Don't Be A Fool - MTV Unplugged","The Other (Stripped)","Love Me Like I'm Gone.","Call You Home","Anaheim","For Me, For Her, For You","Yellow Bird","Make Me (Cry) - Acoustic Version","Louise","Magnetised - Acoustic","California Numb - Acoustic","Ghost - Live From Spotify NYC","On the Run","Rather Be with You - Acoustic","This Town","Falling","Rusty","FourFiveSeconds","Ol' Sweet Day","Miles Away","Burning House","Love And Happiness","Reasons - Acoustic","Life Is Confusing","Already Gone - Acoustic","Before You"],["Linkin Park","The White Stripes","Red Hot Chili Peppers","Nickelback","Evanescence","Papa Roach","Jet","The Killers","Kings of Leon","Jimmy Eat World","Linkin Park","Alien Ant Farm","Red Hot Chili Peppers","System Of A Down","Franz Ferdinand","blink-182","Foo Fighters","Panic! At The Disco","3 Doors Down","Thirty Seconds To Mars","Kings of Leon","Queens of the Stone Age","Caesars","Muse","Plain White T's","Puddle Of Mudd","Green Day","My Chemical Romance","The All-American Rejects","Foo Fighters","Audioslave","Staind","Three Days Grace","Limp Bizkit","Sum 41","Foo Fighters","Rise Against","Drowning Pool","Fall Out Boy","The Strokes","Stone Sour","Breaking Benjamin","Disturbed","Incubus","P.O.D.","U2","AFI","Arctic Monkeys","The Raconteurs","Korn","Hoobastank","Godsmack","Wolfmother","Audioslave","Chevelle","Seether","Muse","Deftones","A Perfect Circle","Beyoncé","Justin Timberlake","Sean Kingston","Britney Spears","Michael Jackson","Usher","T.I.","Shakira","Train","Foster The People","Michael Jackson","The Script","John Legend","Train","Miley Cyrus","Christina Aguilera","Kelly Clarkson","OutKast","Kesha","Chris Brown","Justin Timberlake","Chris Brown","The Script","Pitbull","*NSYNC","Avril Lavigne","Mario","Christina Aguilera","P!nk","Pitbull","One Direction","Alicia Keys","Avril Lavigne","Britney Spears","Pitbull","Beyoncé","Leona Lewis","Destiny's Child","Sara Bareilles","OutKast","Kesha","Destiny's Child","Britney Spears","Justin Timberlake","Daft Punk","T.I.","Ciara","Natasha Bedingfield","Miley Cyrus","P!nk","Shakira","Beyoncé","*NSYNC","Usher","Kings of Leon","Kelly Clarkson","The Fray","The Script","Avril Lavigne","Alicia Keys","Kings of Leon","The Fray","Gavin DeGraw","Carrie Underwood","Christina Aguilera","Usher","Alicia Keys","The Calling","The Fray","Destiny's Child","Kelly Clarkson","P!nk","Good Charlotte","Gavin DeGraw","OutKast","Leona Lewis","Daughtry","Boys Like Girls","John Mayer","Five For Fighting","Ed Sheeran","Lady Gaga","The Lumineers","Kina Grannis","Leon Bridges","Sam Smith","Hozier","Angus &amp; Julia Stone","James TW","John Mayer","Vance Joy","Adele","James Bay","George Ogilvie","Mako","Bishop Briggs","JP Cooper","Lewis Capaldi","George Ezra","Ed Sheeran","Dermot Kennedy","Ray LaMontagne","Charlie Cunningham","Dean Lewis","Juke Ross","Ed Sheeran","JONES","Peter Bradley Adams","Vance Joy","Barns Courtney","Dan Auerbach","Dua Lipa","Olivia O'Brien","Bishop Briggs","Ben Howard","Hozier","Kina Grannis","Hozier","Joseph","Dana Williams","Hollow Coves","Dean Lewis","Birdy","Passenger","Astrid S","Skylar Grey","Donovan Woods","Au/Ra","SYML","Amy Shark","Belle Mt","Tash Sultana","Sia","Hailee Steinfeld","The Lumineers","Lewis Watson","Imaginary Future","Lissie","John Mayer","Billy Raffoul","This Wild Life","Julia Michaels","Ed Sheeran","Kodaline","Dermot Kennedy","Harry Styles","John Smith","Justin Nozuka","Sabrina Claudio","James Bay","Matt Maeson","Jamie Lawson","Noah Kahan","Declan J Donovan","Shawn Mendes","Lauv","Jaws of Love.","Kelvin Jones","Nicole Zefanya","John Adams","Ben Stevenson","Noah Cyrus","Big Brutus","Tom Odell","CLOVES","Halsey","Corey Harper","Sinead Harnett","Niall Horan","Emil Landman","Hein Cooper","Rihanna","AHI","Josh Ritter","Cam","Marc Broussard","Jillian Jacqueline","Langhorne Slim","Brett Dennen","Fortunate Ones"],[66,76,74,56,80,81,76,80,81,78,63,75,81,69,77,71,62,77,79,69,79,13,62,77,79,28,78,77,71,11,77,65,75,74,74,11,73,74,79,70,60,69,73,62,72,57,71,63,64,71,61,67,63,72,71,70,65,69,66,79,74,10,60,70,79,76,84,77,84,74,73,85,78,78,69,75,76,71,71,77,69,76,65,73,77,80,73,54,75,69,79,67,76,75,72,81,63,77,78,72,62,77,77,77,75,78,77,74,65,76,69,67,77,81,52,60,65,69,76,79,83,69,73,72,31,81,67,76,63,75,67,73,63,68,73,64,67,78,48,86,87,65,78,74,23,72,67,70,62,74,75,67,71,61,61,21,65,30,70,21,64,64,62,68,69,50,60,56,56,69,68,77,56,76,61,72,53,50,54,68,64,68,49,30,16,55,26,29,53,65,16,62,63,33,65,68,49,68,31,19,68,75,71,16,72,53,52,60,73,68,56,61,64,15,17,51,57,54,52,38,61,51,65,52,56,56,53,69,54,54,42,19,56,67,53,13,52,58,49],[216933,231733,216933,223826,235893,199893,213800,222586,203346,168253,185586,209266,269000,210240,237026,227240,256600,187613,233933,231533,230760,255066,195666,304840,232533,303920,176346,311106,213106,262733,293960,264706,231480,213760,178266,269373,242280,201960,229093,193373,282946,200546,279213,212733,256240,194520,206586,173680,215266,270920,175026,246040,176306,277840,238400,207213,218000,299533,247266,236133,267266,241933,198813,300026,250373,338853,218093,216666,239600,246026,202533,269560,259933,231240,245960,188960,235213,199693,223933,242733,252160,261426,237120,200400,244506,256733,238560,203306,204160,198053,253813,204000,224400,252306,193213,262466,242013,258826,270506,211920,254040,211160,288333,248413,249533,203786,259333,221360,215160,196160,244826,192426,223440,203346,221920,236373,252853,216600,210200,230760,262533,218520,199946,298853,224946,228706,209360,241853,221626,219493,191666,175093,217760,234000,234173,204853,206520,249626,222000,259550,215733,160097,201933,240600,221049,300706,239146,210106,232706,230506,223080,189146,258651,189660,188906,212152,195579,211763,226226,294000,296386,178826,234775,194066,206209,221492,200800,201561,233448,176026,213436,175466,198693,249173,246500,198403,240146,168480,213061,239960,248176,159506,220468,196072,253400,251324,160345,202106,197573,236618,315598,266720,200880,211851,256415,227619,179063,212626,172199,132453,175280,223573,305746,273666,243804,217973,284038,200864,285866,219151,188057,200613,201250,337840,182000,172480,171613,258000,243629,222842,232906,244866,292186,201839,160400,206637,199704,232600,202483,198582,188238,178053,232000,231333,278146,184840,171413,174053,167164],[0.0103,0.00817,0.0264,0.0009539999999999999,0.00895,0.000504,0.00148,0.00108,0.00172,0.0424,0.0046,0.00434,0.0179,0.000353,0.000423,0.00136,0.00701,0.09379999999999999,0.006640000000000001,0.0014,0.005520000000000001,0.0137,0.0171,0.000202,0.872,0.0102,2.64e-05,0.000289,0.0156,0.000194,0.00797,0.00189,0.00461,0.00506,0.000618,0.000917,0.00164,0.00347,0.00898,0.0223,0.0417,5.53e-05,0.0009960000000000001,0.0006309999999999999,0.00834,0.000153,0.000213,0.00225,0.0132,0.00014,0.000295,4.78e-05,5.1e-05,0.000336,0.000671,0.00018,6.94e-06,0.000249,3.32e-05,0.00249,0.202,0.159,0.0279,0.342,0.0183,0.07099999999999999,0.284,0.217,0.145,0.132,0.0653,0.922,0.154,0.00882,0.235,0.00165,0.103,0.0746,0.0439,0.0584,0.143,0.173,0.0142,0.031,0.0572,0.235,0.578,0.00611,0.0295,0.00761,0.03,6.790000000000001e-05,0.073,0.192,0.0383,0.188,0.00727,0.0208,0.142,0.00498,0.0533,0.3,0.575,0.0426,0.0161,0.042,0.00577,0.407,0.000304,0.236,0.0825,0.0407,0.257,0.00172,0.0411,0.0204,0.0328,0.0007379999999999999,0.263,0.005520000000000001,0.269,0.255,0.271,0.107,0.0251,0.603,0.0392,0.0187,0.388,0.254,0.00127,0.006659999999999999,0.007909999999999999,0.126,0.512,0.017,0.00166,0.0206,0.327,0.779,0.371,0.613,0.905,0.229,0.977,0.464,0.239,0.8029999999999999,0.835,0.312,0.0415,0.856,0.365,0.573,0.634,0.359,0.9179999999999999,0.597,0.518,0.505,0.86,0.852,0.9420000000000001,0.585,0.0425,0.897,0.7240000000000001,0.768,0.401,0.315,0.601,0.71,0.75,0.3,0.841,0.9259999999999999,0.951,0.662,0.785,0.722,0.9470000000000001,0.8370000000000001,0.00182,0.8959999999999999,0.904,0.0579,0.7609999999999999,0.853,0.7390000000000001,0.8220000000000001,0.269,0.887,0.482,0.298,0.6850000000000001,0.887,0.919,0.547,0.785,0.7090000000000001,0.741,0.49,0.172,0.191,0.6579999999999999,0.778,0.722,0.72,0.879,0.8959999999999999,0.7120000000000001,0.821,0.581,0.752,0.8159999999999999,0.85,0.303,0.6629999999999999,0.86,0.6829999999999999,0.8859999999999999,0.7609999999999999,0.9520000000000001,0.889,0.635,0.387,0.8170000000000001,0.711,0.269,0.16,0.868,0.603,0.185,0.887,0.0269,0.8140000000000001,0.955,0.612,0.765],[0.542,0.737,0.451,0.447,0.316,0.581,0.613,0.33,0.542,0.629,0.496,0.647,0.618,0.42,0.278,0.659,0.37,0.5670000000000001,0.545,0.309,0.276,0.518,0.58,0.602,0.657,0.44,0.38,0.217,0.7140000000000001,0.5820000000000001,0.614,0.509,0.498,0.599,0.574,0.433,0.5489999999999999,0.6559999999999999,0.499,0.624,0.545,0.374,0.695,0.246,0.5629999999999999,0.391,0.309,0.535,0.524,0.468,0.5920000000000001,0.213,0.219,0.433,0.509,0.546,0.408,0.269,0.365,0.6459999999999999,0.8909999999999999,0.745,0.774,0.672,0.894,0.375,0.778,0.675,0.733,0.775,0.421,0.422,0.468,0.613,0.435,0.662,0.728,0.755,0.764,0.9670000000000001,0.659,0.63,0.8240000000000001,0.61,0.585,0.6559999999999999,0.457,0.701,0.581,0.7290000000000001,0.649,0.487,0.7240000000000001,0.6709999999999999,0.426,0.638,0.8140000000000001,0.583,0.843,0.711,0.524,0.7509999999999999,0.624,0.794,0.68,0.9440000000000001,0.706,0.53,0.535,0.7929999999999999,0.655,0.636,0.662,0.542,0.555,0.591,0.396,0.5600000000000001,0.653,0.276,0.64,0.63,0.519,0.64,0.8149999999999999,0.609,0.551,0.338,0.517,0.583,0.8059999999999999,0.494,0.423,0.871,0.584,0.423,0.423,0.647,0.521,0.5870000000000001,0.5720000000000001,0.664,0.266,0.58,0.389,0.387,0.763,0.711,0.611,0.388,0.6899999999999999,0.507,0.6840000000000001,0.735,0.7190000000000001,0.41,0.5629999999999999,0.614,0.5629999999999999,0.48,0.522,0.629,0.59,0.636,0.493,0.522,0.643,0.483,0.659,0.5589999999999999,0.826,0.401,0.7,0.545,0.624,0.397,0.415,0.41,0.612,0.5710000000000001,0.483,0.6840000000000001,0.338,0.455,0.5920000000000001,0.5870000000000001,0.589,0.598,0.5710000000000001,0.499,0.59,0.409,0.665,0.391,0.67,0.637,0.655,0.7290000000000001,0.88,0.344,0.6840000000000001,0.843,0.209,0.556,0.468,0.583,0.335,0.632,0.5,0.539,0.8109999999999999,0.701,0.597,0.307,0.376,0.457,0.643,0.485,0.573,0.485,0.604,0.467,0.487,0.73,0.393,0.411,0.579,0.6899999999999999,0.5329999999999999,0.87,0.579,0.393,0.556,0.728,0.884,0.446,0.373,0.555,0.505],[0.853,0.463,0.97,0.7659999999999999,0.945,0.887,0.953,0.9359999999999999,0.905,0.897,0.863,0.9640000000000001,0.9379999999999999,0.929,0.6759999999999999,0.778,0.9440000000000001,0.795,0.865,0.912,0.715,0.5379999999999999,0.981,0.905,0.291,0.9320000000000001,0.988,0.905,0.725,0.597,0.5679999999999999,0.774,0.83,0.9320000000000001,0.9109999999999999,0.9590000000000001,0.93,0.9320000000000001,0.8240000000000001,0.899,0.753,0.961,0.8759999999999999,0.768,0.86,0.831,0.875,0.948,0.578,0.769,0.9320000000000001,0.93,0.9520000000000001,0.8540000000000001,0.843,0.9590000000000001,0.965,0.853,0.894,0.77,0.7140000000000001,0.6659999999999999,0.847,0.8320000000000001,0.7909999999999999,0.862,0.8240000000000001,0.885,0.71,0.7190000000000001,0.873,0.264,0.64,0.622,0.92,0.741,0.9740000000000001,0.8320000000000001,0.6940000000000001,0.583,0.696,0.698,0.743,0.9259999999999999,0.7759999999999999,0.578,0.573,0.7,0.963,0.7709999999999999,0.552,0.9,0.695,0.9390000000000001,0.584,0.6559999999999999,0.899,0.7859999999999999,0.805,0.7,0.904,0.8340000000000001,0.653,0.8109999999999999,0.6870000000000001,0.511,0.8009999999999999,0.422,0.8859999999999999,0.8320000000000001,0.488,0.873,0.507,0.905,0.9229999999999999,0.6990000000000001,0.629,0.9590000000000001,0.609,0.715,0.743,0.894,0.7490000000000001,0.889,0.8079999999999999,0.445,0.696,0.8029999999999999,0.598,0.584,0.902,0.9390000000000001,0.862,0.597,0.7,0.922,0.9399999999999999,0.7290000000000001,0.431,0.299,0.385,0.573,0.0596,0.6870000000000001,0.294,0.278,0.387,0.299,0.313,0.66,0.524,0.408,0.5429999999999999,0.43,0.27,0.428,0.261,0.527,0.26,0.418,0.256,0.451,0.233,0.383,0.4,0.241,0.436,0.49,0.608,0.466,0.345,0.398,0.281,0.485,0.214,0.249,0.11,0.44,0.365,0.5579999999999999,0.199,0.341,0.721,0.113,0.206,0.608,0.467,0.343,0.313,0.229,0.6970000000000001,0.375,0.274,0.442,0.294,0.129,0.127,0.546,0.245,0.46,0.342,0.4,0.412,0.448,0.197,0.235,0.4429999999999999,0.293,0.213,0.263,0.38,0.234,0.425,0.353,0.371,0.441,0.46,0.307,0.206,0.353,0.261,0.324,0.0746,0.286,0.5529999999999999,0.512,0.256,0.407,0.679,0.5720000000000001,0.268,0.5579999999999999,0.5920000000000001,0.253,0.469,0.388,0.216,0.463,0.252],[0.108,0.255,0.102,0.113,0.396,0.268,0.152,0.0926,0.136,0.263,0.639,0.15,0.167,0.122,0.136,0.08409999999999999,0.135,0.114,0.168,0.5820000000000001,0.201,0.141,0.386,0.117,0.114,0.142,0.368,0.222,0.0726,0.517,0.0997,0.143,0.139,0.269,0.0769,0.028,0.39,0.144,0.163,0.0975,0.389,0.138,0.106,0.102,0.39,0.141,0.113,0.376,0.108,0.271,0.138,0.126,0.157,0.162,0.348,0.0584,0.11,0.118,0.267,0.07149999999999999,0.0521,0.302,0.241,0.242,0.0388,0.211,0.405,0.08599999999999999,0.0956,0.06619999999999999,0.123,0.132,0.154,0.37,0.552,0.114,0.175,0.291,0.18,0.0519,0.13,0.0789,0.237,0.08210000000000001,0.3,0.118,0.114,0.0295,0.139,0.08699999999999999,0.111,0.358,0.08890000000000001,0.298,0.188,0.146,0.0979,0.188,0.0771,0.215,0.7759999999999999,0.355,0.104,0.101,0.261,0.0379,0.0822,0.107,0.257,0.202,0.221,0.0372,0.0465,0.136,0.112,0.0614,0.183,0.209,0.233,0.201,0.101,0.181,0.119,0.339,0.12,0.104,0.127,0.136,0.183,0.123,0.212,0.139,0.133,0.0638,0.13,0.102,0.178,0.134,0.09859999999999999,0.123,0.231,0.0857,0.132,0.109,0.107,0.102,0.13,0.116,0.111,0.09429999999999999,0.17,0.102,0.113,0.111,0.111,0.138,0.0982,0.11,0.146,0.11,0.142,0.141,0.11,0.122,0.133,0.11,0.11,0.112,0.117,0.09329999999999999,0.121,0.09619999999999999,0.102,0.119,0.701,0.115,0.09619999999999999,0.0663,0.111,0.116,0.109,0.0883,0.349,0.0978,0.121,0.131,0.0847,0.123,0.113,0.0914,0.0881,0.125,0.118,0.13,0.147,0.07190000000000001,0.105,0.06510000000000001,0.0979,0.117,0.07290000000000001,0.125,0.0843,0.383,0.109,0.187,0.0921,0.326,0.721,0.104,0.309,0.102,0.1,0.163,0.337,0.115,0.115,0.123,0.114,0.106,0.142,0.122,0.108,0.173,0.6759999999999999,0.06759999999999999,0.134,0.126,0.112,0.0993,0.12,0.108,0.109,0.133,0.073,0.119,0.07389999999999999,0.142,0.0829],[-6.407,-7.827999999999999,-4.938,-5.065,-3.169,-3.659,-3.435,-3.66,-5.653,-3.401,-4.153,-4.225,-3.442,-3.899,-8.821,-6.422999999999999,-4.979,-4.985,-5.707999999999999,-3.881,-5.356,-5.818,-2.603,-4.046,-10.572,-4.488,-2.042,-4.103,-6.411,-5.671,-5.477,-4.053999999999999,-5.157,-3.328,-5.176,-4.04,-3.468,-3.405,-4.741000000000001,-5.71,-4.618,-4.421,-4.262,-7.48,-7.532999999999999,-3.892,-4.49,-4.19,-4.563,-7.036,-4.491000000000001,-4.478,-3.621,-3.868,-3.318,-4.664,-4.232,-4.647,-4.681999999999999,-6.596,-6.055,-5.899,-3.925,-2.388,-4.699,-3.363,-5.892,-4.431999999999999,-5.849,-6.212000000000001,-4.343,-7.064,-5.862,-5.794,-1.357,-5.406000000000001,-2.261,-2.741,-5.745,-5.562,-4.291,-4.51,-5.995,-4.843,-5.898,-8.970000000000001,-3.866,-4.934,-4.087,-2.451,-5.419,-4.417,-5.226,-3.206,-5.292999999999999,-5.886,-5.957999999999999,-3.142,-5.946000000000001,-4.805,-2.071,-5.444,-6.582000000000001,-8.966000000000001,-6.162000000000001,-10.96,-6.332999999999999,-6.262,-3.106,-4.862,-9.17,-4.672,-8.238,-5.653,-5.907999999999999,-5.221,-4.78,-2.433,-7.519,-5.356,-4.08,-4.592,-3.318,-3.073,-4.614,-9.129,-6.192,-5.412000000000001,-3.751,-5.362,-3.387,-3.127,-5.13,-4.931999999999999,-4.251,-2.602,-4.012,-6.251,-9.74,-7.365,-6.362,-6.519,-18.515,-5.4,-5.428999999999999,-8.454000000000001,-8.642999999999999,-8.286,-10.242,-7.372000000000001,-8.390000000000001,-7.652,-5.579,-9.532,-10.534,-7.927,-9.250999999999999,-6.374,-5.856,-9.622,-11.216,-9.974,-10.962,-9.381,-8.117000000000001,-8.966000000000001,-12.245,-4.736000000000001,-8.566000000000001,-6.769,-6.018,-8.993,-6.576000000000001,-9.941000000000001,-9.471,-10.484,-14.901,-8.616,-9.972999999999999,-8.552999999999999,-11.37,-9.497,-5.735,-12.887,-12.026,-11.588,-8.179,-11.04,-9.833,-9.642000000000001,-5.877000000000001,-6.195,-8.914999999999999,-8.076000000000001,-8.113999999999999,-17.082,-11.036,-9.305,-10.245,-9.398999999999999,-6.09,-5.576000000000001,-9.732999999999999,-10.921,-11.727,-10.121,-9.565,-12.507,-9.095000000000001,-11.149,-6.235,-10.441,-5.513,-9.965,-6.58,-9.866,-6.962999999999999,-13.129,-10.707,-11.212,-7.736000000000001,-11.487,-12.952,-8.277000000000001,-6.718999999999999,-7.491000000000001,-8.306000000000001,-7.739,-8.346,-7.667000000000001,-5.65,-9.429,-7.121,-8.427,-9.852,-6.201000000000001,-11.41,-7.994,-10.169],[0.0498,0.07920000000000001,0.107,0.0313,0.124,0.0624,0.08550000000000001,0.0917,0.05400000000000001,0.0483,0.0381,0.06,0.0456,0.121,0.0371,0.0379,0.0767,0.134,0.0286,0.0646,0.0432,0.0486,0.06,0.0775,0.0293,0.0584,0.0639,0.0752,0.0402,0.0512,0.0276,0.0338,0.0421,0.18,0.07149999999999999,0.0431,0.0487,0.0708,0.0794,0.0295,0.036,0.0851,0.0553,0.0387,0.0621,0.0613,0.0488,0.0356,0.12,0.04099999999999999,0.0885,0.06710000000000001,0.176,0.0483,0.0488,0.08199999999999999,0.05,0.0854,0.0572,0.226,0.14,0.0566,0.121,0.342,0.112,0.255,0.0712,0.0436,0.0292,0.0435,0.0565,0.0322,0.0275,0.0334,0.201,0.0334,0.0665,0.116,0.189,0.0789,0.07099999999999999,0.0244,0.141,0.0479,0.0459,0.0922,0.0275,0.0876,0.09810000000000001,0.0725,0.0292,0.0482,0.0622,0.161,0.296,0.0357,0.06370000000000001,0.0301,0.269,0.046,0.398,0.0437,0.176,0.038,0.0709,0.161,0.0399,0.0342,0.045,0.0406,0.22,0.07099999999999999,0.118,0.05400000000000001,0.0482,0.0449,0.0287,0.102,0.03700000000000001,0.0432,0.0379,0.0544,0.0405,0.322,0.0511,0.106,0.0265,0.0413,0.263,0.0314,0.0475,0.126,0.06950000000000001,0.0464,0.0506,0.0411,0.0635,0.0236,0.0293,0.0263,0.0308,0.0277,0.0363,0.106,0.0277,0.0318,0.0278,0.0394,0.0339,0.0308,0.103,0.0396,0.0281,0.0349,0.0349,0.0329,0.0709,0.0302,0.0391,0.0312,0.0258,0.0284,0.043,0.0434,0.0261,0.0343,0.0273,0.0318,0.0325,0.0362,0.0372,0.183,0.0356,0.151,0.0457,0.0394,0.0388,0.0307,0.0281,0.0281,0.0586,0.0272,0.0587,0.0466,0.0274,0.0308,0.031,0.025,0.06569999999999999,0.0361,0.0291,0.0336,0.147,0.0347,0.0341,0.0346,0.0467,0.0285,0.446,0.0319,0.055,0.103,0.0443,0.0387,0.033,0.0287,0.0382,0.0284,0.0462,0.0552,0.0406,0.0443,0.0295,0.0462,0.0365,0.0286,0.0272,0.0565,0.0314,0.0296,0.0598,0.0309,0.0327,0.0545,0.22,0.027,0.0384,0.0297,0.0329,0.039,0.0442,0.0475,0.0393,0.0304,0.0372,0.0405,0.0326,0.0343,0.0321],[105.256,123.881,122.444,172.011,189.931,90.57799999999999,105.046,148.112,153.398,161.944,110.018,126.942,91.455,127.204,104.545,110.022,130.315,170.06,99.01000000000001,183.035,137.028,170.953,134.007,128.019,103.973,157.438,186.113,96.95,99.988,167.738,107.849,116.529,89.34200000000001,96.23399999999999,98.075,172.984,112.447,130.936,161.977,104.055,105.754,167.032,89.95399999999999,169.873,97.867,139.946,143.526,103.183,123.669,104.102,93.675,169.221,112.886,89.40000000000001,140.055,127.831,136.018,141.581,82.30500000000001,99.16500000000001,100.972,129.995,143.011,117.298,105.018,159.841,100.024,97.03,127.975,117.513,84.803,119.93,79.297,80.003,188.899,131,79.52600000000001,120.032,146.075,117,86.001,94.023,127.046,172.638,77.98699999999999,94.514,76.193,122.035,129.992,125.011,89.96899999999999,149.937,139,129.023,193.437,104.036,119.011,123.052,94.946,128.001,161.188,95.053,73.884,116.047,150.053,113.046,100.013,119.964,126.012,107.661,91.02500000000001,165.071,86.41200000000001,153.398,116.012,116.029,173.794,163.983,95.98200000000001,137.028,122.035,142.051,147.905,99.931,110.063,118.393,112.024,151.994,96.93299999999999,140.039,128.943,177.751,154.746,125.999,163.953,156.063,149.934,94.01000000000001,106.546,94.992,95.79899999999999,76.023,181.74,76.014,88.63600000000001,153.426,109.957,125.068,134.858,143.554,164.023,140.038,140.996,129.942,129.965,88.361,125.129,121.941,145.561,132.404,76.34999999999999,90.965,78.178,72.87100000000001,91.00399999999999,133.644,91.485,137.606,113.952,117.21,116.072,180.293,74.998,80.40100000000001,125.149,79.61399999999999,81.876,98.09700000000001,97.929,104.991,78.10300000000001,75.94800000000001,80.774,176.131,93.934,94.479,165.908,103.984,64.53100000000001,178.461,146.059,128.912,103.013,142.56,119.856,125.802,150.407,119.941,76.006,84.46899999999999,114.076,100.728,86.26000000000001,116.292,144.212,137.829,169.135,103.869,140.053,119.671,98.04000000000001,84.995,119.998,174.927,90.514,171.758,90.01100000000001,80.17100000000001,123.752,114.064,77.245,100.89,106.328,83.98,187.673,83.399,109.901,111.916,87.995,119.98,205.903,112.64,138.041,140.923,94.345,175.154,129.03,88.399,80.83],[0.37,0.324,0.198,0.574,0.32,0.7240000000000001,0.537,0.234,0.374,0.93,0.243,0.875,0.875,0.3,0.494,0.623,0.345,0.635,0.5429999999999999,0.302,0.173,0.6870000000000001,0.861,0.411,0.298,0.495,0.769,0.236,0.59,0.674,0.516,0.0824,0.453,0.6920000000000001,0.573,0.365,0.526,0.544,0.6990000000000001,0.797,0.434,0.357,0.9409999999999999,0.35,0.517,0.6829999999999999,0.725,0.778,0.537,0.17,0.698,0.386,0.172,0.368,0.332,0.416,0.349,0.179,0.31,0.6809999999999999,0.8179999999999999,0.708,0.9229999999999999,0.5489999999999999,0.583,0.478,0.7559999999999999,0.768,0.965,0.7120000000000001,0.63,0.331,0.499,0.484,0.45,0.404,0.965,0.735,0.581,0.9640000000000001,0.665,0.529,0.804,0.861,0.427,0.556,0.0992,0.625,0.7879999999999999,0.873,0.158,0.484,0.235,0.529,0.272,0.225,0.545,0.573,0.615,0.8009999999999999,0.655,0.894,0.5649999999999999,0.862,0.467,0.8420000000000001,0.63,0.349,0.445,0.872,0.7909999999999999,0.9079999999999999,0.6759999999999999,0.374,0.6820000000000001,0.733,0.358,0.67,0.482,0.173,0.361,0.364,0.29,0.436,0.746,0.166,0.354,0.4,0.922,0.136,0.961,0.893,0.462,0.635,0.5489999999999999,0.5670000000000001,0.505,0.6870000000000001,0.181,0.356,0.323,0.5660000000000001,0.143,0.187,0.243,0.06320000000000001,0.273,0.5770000000000001,0.3779999999999999,0.401,0.5620000000000001,0.53,0.361,0.522,0.299,0.526,0.411,0.354,0.616,0.319,0.13,0.6809999999999999,0.597,0.213,0.15,0.345,0.422,0.43,0.393,0.623,0.508,0.265,0.385,0.341,0.3,0.329,0.234,0.304,0.171,0.283,0.16,0.5570000000000001,0.381,0.373,0.198,0.5649999999999999,0.5710000000000001,0.419,0.163,0.239,0.4970000000000001,0.209,0.6859999999999999,0.246,0.515,0.298,0.436,0.406,0.638,0.528,0.632,0.927,0.162,0.125,0.249,0.368,0.184,0.586,0.37,0.222,0.647,0.298,0.309,0.199,0.395,0.654,0.657,0.132,0.222,0.0706,0.361,0.445,0.123,0.446,0.164,0.0544,0.258,0.181,0.21,0.8540000000000001,0.321,0.336,0.196,0.457,0.897,0.581,0.496,0.6609999999999999,0.393]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>song_name<\/th>\n      <th>artist<\/th>\n      <th>song_popularity<\/th>\n      <th>song_duration_ms<\/th>\n      <th>acousticness<\/th>\n      <th>danceability<\/th>\n      <th>energy<\/th>\n      <th>liveness<\/th>\n      <th>loudness<\/th>\n      <th>speechiness<\/th>\n      <th>tempo<\/th>\n      <th>audio_valence<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="scaling" class="level3">
<h3 class="anchored" data-anchor-id="scaling">Scaling</h3>
<p>We see above that the audio features are on different scales - for example, <code>tempo</code> ranges from around 64-206 while <code>acousticness</code> ranges from 0-1.</p>
<p>Note that the audio features are scaled to have mean 0 and standard deviation 1. This is important because features with different scales can have a disproportionate impact on the clustering algorithm. For example, if one feature has a range of 0-1 and another has a range of 0-100, the clustering algorithm may be biased towards the feature with the larger range. By using scaled features, we ensure that each feature has equal weight in the clustering algorithm.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interested in numeric audio features</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>numeric_spotify<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">scale</span>(spotify[,<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="fu">length</span>(spotify))]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pairs-plot" class="level3">
<h3 class="anchored" data-anchor-id="pairs-plot">Pairs Plot</h3>
<p>The pairs plot provides a useful overview of the data and can give us a sense of clearly differentiated features and possible relationships among features in the dataset.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="dv">1</span>, <span class="fl">0.4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing Values</h3>
<p>We check for missing values in the dataset and find that there are none.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(numeric_spotify))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix">Correlation Matrix</h3>
<p>We can also look at the correlation matrix to see if there are any strong correlations between the features. This can help us identify redundant features that may not add much information to the clustering process.</p>
<section id="observations" class="level4">
<h4 class="anchored" data-anchor-id="observations">Observations:</h4>
<ul>
<li><strong>High Positive Correlation</strong>: Features like <code>energy</code> and <code>loudness</code> show strong positive correlations, as indicated by deep red squares. This suggests that louder tracks tend to be more energetic.</li>
<li><strong>Negative Correlation</strong>: There is a noticeable negative correlation between <code>acousticness</code> and <code>loudness</code>, highlighted by the blue color. Tracks that are more acoustic tend to be quieter.</li>
<li><strong>Neutral to Low Correlation</strong>: Features such as <code>song_popularity</code> do not exhibit strong correlations with most other musical features, implying that popularity may be influenced by factors outside of these measured attributes.</li>
</ul>
</section>
<section id="analysis-of-clusters" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-clusters">Analysis of Clusters:</h4>
<ul>
<li><p>Close Correlations: Features that join at lower heights (closer to the matrix) are more closely correlated. For instance, if energy and loudness merge at a lower height compared to other pairs, it suggests a strong positive correlation, as also indicated by the red color in the matrix.</p></li>
<li><p>Distant Correlations: Conversely, features that join at higher points on the dendrogram have less in common, showing either low correlation or high negative correlation.</p></li>
</ul>
</section>
<section id="implications" class="level4">
<h4 class="anchored" data-anchor-id="implications">Implications:</h4>
<p>The clustering at the top of the matrix, shown with dendrograms, groups similar features based on their correlation coefficients, this suggests that dimensionality reduction could be beneficial for this dataset. By removing redundant features, we could simplify the dataset and potentially improve the clustering results.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_spotify)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># visualise the correlation matrix</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(cor_matrix, <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">100</span>), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">symm =</span> <span class="cn">TRUE</span>, <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="fitting-the-clustering-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-clustering-algorithm">Fitting the Clustering Algorithm</h2>
<p>Now we produce two fits using 2 and 3 clusters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># produce the two fits below for 2 and 3 clusters.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In our visualisations below, we show the pairs plot with the symbol and colour corresponding to the clusters. We can see that the clusters are well separated in both cases.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>symb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkorange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"magenta3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">K = 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">K = 3</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit2<span class="sc">$</span>cluster],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit2<span class="sc">$</span>cluster], <span class="fl">0.4</span>), </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit3<span class="sc">$</span>cluster],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit3<span class="sc">$</span>cluster], <span class="fl">0.4</span>), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="internal-validation" class="level2">
<h2 class="anchored" data-anchor-id="internal-validation">Internal Validation</h2>
<p>Internal validation is used to determine the optimal number of clusters. It is particularly useful when the true number of clusters is unknown.</p>
<section id="calinski-harabasz-index" class="level3">
<h3 class="anchored" data-anchor-id="calinski-harabasz-index">Calinski-Harabasz Index</h3>
<p>Next we compute the Calinski-Harabasz index in order to find the optimal number of clusters.</p>
<p>This index is a measure of cluster cohesion and separation. It is defined as the ratio of the sum of between-cluster dispersion to within-cluster dispersion. A higher value of the index indicates better clustering.</p>
<p><span class="math display">\[CH(K) = \frac{B(K)}{W(K)} \times \frac{N-K}{K-1}\]</span></p>
<p>where <span class="math inline">\(B(K)\)</span> is the between-cluster dispersion, <span class="math inline">\(W(K)\)</span> is the within-cluster dispersion, and <span class="math inline">\(N\)</span> is the number of observations.</p>
<p>A large value of this index for a given <span class="math inline">\(K\)</span> indicates that the clustering is good as it has a high <em>between-cluster dispersion</em> and low <em>within-cluster dispersion.</em></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># set K max</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> bss <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, K) <span class="co"># initialise empty vectors</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K ) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run kmeans for each value of k</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  wss[k] <span class="ot">&lt;-</span> fit<span class="sc">$</span>tot.withinss <span class="co"># store total within sum of squares</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  bss[k] <span class="ot">&lt;-</span> fit<span class="sc">$</span>betweenss</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute calinski-harabasz index</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(numeric_spotify)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">&lt;-</span> ( bss<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>K <span class="sc">-</span> <span class="dv">1</span>) ) <span class="sc">/</span> ( wss<span class="sc">/</span>(N <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span>K) )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ch[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># the value of CH index for K = 1 is set to zero</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>K, ch, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"CH"</span>, <span class="at">xlab =</span> <span class="st">"K"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"Calinski-Harabasz Index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From observing our results from the CH index plot above, the optimal number of clusters appears to be 2 or 3.</p>
</section>
<section id="silhouette-plot" class="level3">
<h3 class="anchored" data-anchor-id="silhouette-plot">Silhouette Plot</h3>
<p>We can further assess cluster coherence by looking at the silhouettes.</p>
<p>The silhouette value for each observation is a measure of how similar it is to its own cluster compared to other clusters. The silhouette value ranges from -1 to 1, with a value of 1 indicating that the observation is well matched to its own cluster and poorly matched to neighboring clusters. A value of -1 indicates the opposite.</p>
<p>The silhouette for observation <span class="math inline">\(x_i\)</span> is defined as: <span class="math display">\[
s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}
\]</span></p>
<p>We observe that K=2 seems best as the average silhouette is slightly larger for K=2. Additionally, we note that there are observations with negative silhouette in K=3 which indicates ambiguous cluster membership.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(numeric_spotify, <span class="at">method =</span> <span class="st">"euclidean"</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sil2 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(fit2<span class="sc">$</span>cluster, d)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>sil3 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(fit3<span class="sc">$</span>cluster, d)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># produce the two silhouette plots</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>( <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sil2, <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="fl">0.9</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Spotify - K = 2"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sil3, <span class="at">col =</span> <span class="fu">adjustcolor</span>(col, <span class="fl">0.9</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Spotify - K = 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on this analysis, the appropriate number of clusters is K=2 with K=3 being a close second.</p>
</section>
</section>
<section id="external-validation" class="level2">
<h2 class="anchored" data-anchor-id="external-validation">External Validation</h2>
<p>External validation is used to compare the clustering results to a known partition of the data.</p>
<section id="visually-comparing-clustering-to-genre-classification" class="level3">
<h3 class="anchored" data-anchor-id="visually-comparing-clustering-to-genre-classification">Visually Comparing Clustering to Genre Classification</h3>
<p>Now we compare the clustering obtained to the classification into genres, providing a brief interpretation of the clusters.</p>
<section id="two-cluster-solution" class="level4">
<h4 class="anchored" data-anchor-id="two-cluster-solution">Two Cluster Solution</h4>
<p>Firstly we note that there are 3 genres, and hence using our obtained clustering with K=2 is not likely to capture the 3 genres entirely accurately.</p>
<p>The first figure below is a plot with symbol and colour corresponding to one of the three genres: rock, pop, and acoustic. The second figure is a plot with the symbol and colour corresponding to the two clusters.</p>
<p>If we flick between these two figures in the panels below, we can see that the orange and blue genres correspond to the orange cluster, and the purple genre corresponds to the blue cluster. This suggests that the orange and blue genres (<span style="color:orange;">rock</span> and <span style="color:blue;">pop</span>) have a great deal in common compared to the purple genre (<span style="color:purple;">acoustic</span>).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Three Genres</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Two Clusters</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the genre</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[spotify<span class="sc">$</span>genre],</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[spotify<span class="sc">$</span>genre], <span class="fl">0.4</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Actual Genres"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the cluster</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit2<span class="sc">$</span>cluster],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit2<span class="sc">$</span>cluster], <span class="fl">0.4</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="three-cluster-solution" class="level4">
<h4 class="anchored" data-anchor-id="three-cluster-solution">Three Cluster Solution</h4>
<p>We also found that K=3 had the second highest CH value and an average silhouette value quite similar to K=2 (0.32 vs 0.39). As there are 3 genres, we can also plot these 3 clusters beside the 3 genres to see if this clustering compares better than the 2 clusters we previously used.</p>
<p>If we flick between these two plots, we can see that there is a relatively good separation between the three genres.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Three Genres</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Three Clusters</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the genre</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[spotify<span class="sc">$</span>genre],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[spotify<span class="sc">$</span>genre], <span class="fl">0.4</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Actual Genres"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the cluster</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit3<span class="sc">$</span>cluster],</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit3<span class="sc">$</span>cluster], <span class="fl">0.4</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="clustering_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="rand-index" class="level3">
<h3 class="anchored" data-anchor-id="rand-index">Rand Index</h3>
<p>Instead of visually comparing the clusterings obtained to the classification into genres as we have up to now, we can also use the Rand and Adjusted Rand indices to compare our clustering solutions to the reference partition (the 3 genres) and see how well they agree (a socre of 1 represents strong agreement).</p>
<p>For our first table with the 3 clusters, we can see that the rock and pop genres are somewhat mixed and misidentified by clusters 1 and 2. However, we note that the acoustic genre is almost entirely correctly identified in cluster 2. The rand index in this case is 0.77 and the adjusted rand index is 0.5.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cross tabulation between the partitions -- K = 3</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span>(fit3<span class="sc">$</span>cluster, spotify<span class="sc">$</span>genre)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   
    rock pop acoustic
  1    1   5       90
  2   23  56        6
  3   35  19        4</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">classAgreement</span>(tab1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$diag
[1] 0.2552301

$kappa
[1] -0.09483491

$rand
[1] 0.7744805

$crand
[1] 0.5007643</code></pre>
</div>
</div>
<p>For the second table with the 2 clusters, we can see that the rock and pop genres are captured almost entirely accurately by cluster 1. The acoustic genre is captured fairly accurately by cluster 2. The rand index is 0.73 and the adjusted rand index is 0.47.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cross tabulation between the partitions -- K = 2</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(fit2<span class="sc">$</span>cluster, spotify<span class="sc">$</span>genre)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   
    rock pop acoustic
  1   58  75       10
  2    1   5       90</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">classAgreement</span>(tab2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$diag
[1] 0.2635983

$kappa
[1] -0.02585114

$rand
[1] 0.7342569

$crand
[1] 0.4741481</code></pre>
</div>
</div>
</section>
</section>
<section id="interpreting-the-clusters" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-clusters">Interpreting the Clusters</h2>
<p>Finally we will provide a brief interpretation of the clusters when K=2 (the optimal solution we identified in our analysis)</p>
<p><strong>First Cluster</strong></p>
<p>The first cluster corresponds to the rock and pop genres - suggesting that they are similar in a number of features.</p>
<p><strong>Second Cluster</strong></p>
<p>The second cluster captures the acoustic genre. As we noted from the silhouette plot when K=2, there is little ambiguity between these two clusters which suggests that the acoustic genre is greatly differentiated from the rock and pop genres.</p>
<p><strong>A Note on the Three Cluster Solution</strong></p>
<p>We also note that when K=3, there is some confusion with clusters 1 and 2 misidentifying many of the songs in the rock and pop genres which suggests that they are not very clearly differentiated from each other compared to the acoustic genre. This aligns with our expectation that the rock and pop genres are more similar to each other than to the acoustic genre.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb25" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Clustering in R"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add toc to html</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> show</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true # add code tools to html </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add author and date</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Enda Flynn"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-07-28"</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">  light: cosmo</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">  dark: darkly</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>_Note that you can collapse the code using the button on the top right to focus on the analysis._</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>This analysis will focus on clustering songs based on their audio features. We will use the k-means algorithm to group songs into clusters based on their audio attributes. We will explore the data, fit the clustering algorithm, and evaluate the results using internal and external validation methods.</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>The data is extracted from <span class="co">[</span><span class="ot">Spotify</span><span class="co">](https://developer.spotify.com/)</span> and includes various audio features of songs. The dataset contains information on 239 songs and their audio features, such as danceability, energy, and tempo. </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quarto</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>This analysis also demonstrates the utility of <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org/)</span> for sharing analysis and writing reports. Quarto allows for the integration of code, text, and visualizations in a single document, making it easy to create interactive and dynamic reports. We also make use of tabsets to compare different clustering solutions and visualizations.</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false  </span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## EDA</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>We begin by outputting a table and inspecting the data.</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>There are 239 songs (rows) and the columns are as follows:</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`song_name`</span>: the title of the song</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`artist`</span>: the artist of the song</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`genre`</span>: the genre of the song</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`song_popularity`</span>: the popularity of the song</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`song_duration_ms`</span>: the duration of the song in milliseconds</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`acousticness`</span>: a measure of the song's acousticness</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`danceability`</span>: a measure of the song's danceability</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`energy`</span>: a measure of the song's energy</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`liveness`</span>: a measure of the song's liveness</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`loudness`</span>: a measure of the song's loudness</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`speechiness`</span>: a measure of the song's speechiness</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`tempo`</span>: the tempo of the song</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`audio_valence`</span>: a measure of the song's valence</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"data/data_spotify_songs.rda"</span>)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(spotify)</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scaling</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>We see above that the audio features are on different scales - for example, <span class="in">`tempo`</span> ranges from around 64-206 while <span class="in">`acousticness`</span> ranges from 0-1.</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>Note that the audio features are scaled to have mean 0 and standard deviation 1. This is important because features with different scales can have a disproportionate impact on the clustering algorithm. For example, if one feature has a range of 0-1 and another has a range of 0-100, the clustering algorithm may be biased towards the feature with the larger range. By using scaled features, we ensure that each feature has equal weight in the clustering algorithm.</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="co"># interested in numeric audio features</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>numeric_spotify<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">scale</span>(spotify[,<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="fu">length</span>(spotify))]))</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pairs Plot</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>The pairs plot provides a useful overview of the data and can give us a sense of clearly differentiated features and possible relationships among features in the dataset.</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="dv">1</span>, <span class="fl">0.4</span>))</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="fu">### Missing Values</span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>We check for missing values in the dataset and find that there are none.</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(numeric_spotify))</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlation Matrix</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>We can also look at the correlation matrix to see if there are any strong correlations between the features. This can help us identify redundant features that may not add much information to the clustering process.</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Observations:</span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High Positive Correlation**: Features like <span class="in">`energy`</span> and <span class="in">`loudness`</span> show strong positive correlations, as indicated by deep red squares. This suggests that louder tracks tend to be more energetic.</span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Negative Correlation**: There is a noticeable negative correlation between <span class="in">`acousticness`</span> and <span class="in">`loudness`</span>, highlighted by the blue color. Tracks that are more acoustic tend to be quieter.</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Neutral to Low Correlation**: Features such as <span class="in">`song_popularity`</span> do not exhibit strong correlations with most other musical features, implying that popularity may be influenced by factors outside of these measured attributes.</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Analysis of Clusters:</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Close Correlations: Features that join at lower heights (closer to the matrix) are more closely correlated. For instance, if energy and loudness merge at a lower height compared to other pairs, it suggests a strong positive correlation, as also indicated by the red color in the matrix.</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Distant Correlations: Conversely, features that join at higher points on the dendrogram have less in common, showing either low correlation or high negative correlation.</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Implications:</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>The clustering at the top of the matrix, shown with dendrograms, groups similar features based on their correlation coefficients, this suggests that dimensionality reduction could be beneficial for this dataset. By removing redundant features, we could simplify the dataset and potentially improve the clustering results.</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(numeric_spotify)</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a><span class="co"># visualise the correlation matrix</span></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(cor_matrix, <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">100</span>), </span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">symm =</span> <span class="cn">TRUE</span>, <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting the Clustering Algorithm</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>Now we produce two fits using 2 and 3 clusters. </span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a><span class="co"># produce the two fits below for 2 and 3 clusters.</span></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>In our visualisations below, we show the pairs plot with the symbol and colour corresponding to the clusters. We can see that the clusters are well separated in both cases.</span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>symb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>)</span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkorange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"magenta3"</span>)</span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### K = 2</span></span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit2<span class="sc">$</span>cluster],</span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit2<span class="sc">$</span>cluster], <span class="fl">0.4</span>), </span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 2"</span>)</span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a><span class="fu">### K = 3</span></span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify, <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit3<span class="sc">$</span>cluster],</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit3<span class="sc">$</span>cluster], <span class="fl">0.4</span>), </span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 3"</span>)</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Internal Validation</span></span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>Internal validation is used to determine the optimal number of clusters. It is particularly useful when the true number of clusters is unknown. </span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calinski-Harabasz Index</span></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a>Next we compute the Calinski-Harabasz index in order to find the optimal number of clusters.</span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a>This index is a measure of cluster cohesion and separation. It is defined as the ratio of the sum of between-cluster dispersion to within-cluster dispersion. A higher value of the index indicates better clustering.</span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>$$CH(K) = \frac{B(K)}{W(K)} \times \frac{N-K}{K-1}$$</span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>where $B(K)$ is the between-cluster dispersion, $W(K)$ is the within-cluster dispersion, and $N$ is the number of observations.</span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a>A large value of this index for a given $K$ indicates that the clustering is good as it has a high _between-cluster dispersion_ and low _within-cluster dispersion._</span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># set K max</span></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> bss <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, K) <span class="co"># initialise empty vectors</span></span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K ) {</span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run kmeans for each value of k</span></span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_spotify, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a>  wss[k] <span class="ot">&lt;-</span> fit<span class="sc">$</span>tot.withinss <span class="co"># store total within sum of squares</span></span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a>  bss[k] <span class="ot">&lt;-</span> fit<span class="sc">$</span>betweenss</span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a><span class="co"># compute calinski-harabasz index</span></span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(numeric_spotify)</span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">&lt;-</span> ( bss<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>K <span class="sc">-</span> <span class="dv">1</span>) ) <span class="sc">/</span> ( wss<span class="sc">/</span>(N <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span>K) )</span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a>ch[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># the value of CH index for K = 1 is set to zero</span></span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>K, ch, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"CH"</span>, <span class="at">xlab =</span> <span class="st">"K"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"Calinski-Harabasz Index"</span>)</span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a>From observing our results from the CH index plot above, the optimal number of clusters appears to be 2 or 3.</span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a><span class="fu">### Silhouette Plot</span></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a>We can further assess cluster coherence by looking at the silhouettes. </span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a>The silhouette value for each observation is a measure of how similar it is to its own cluster compared to other clusters. The silhouette value ranges from -1 to 1, with a value of 1 indicating that the observation is well matched to its own cluster and poorly matched to neighboring clusters. A value of -1 indicates the opposite.</span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a>The silhouette for observation $x_i$ is defined as:</span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a>s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}</span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a>We observe that K=2 seems best as the average silhouette is slightly larger for K=2. Additionally, we note that there are observations with negative silhouette in K=3 which indicates ambiguous cluster membership.</span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(numeric_spotify, <span class="at">method =</span> <span class="st">"euclidean"</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a>sil2 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(fit2<span class="sc">$</span>cluster, d)</span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a>sil3 <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(fit3<span class="sc">$</span>cluster, d)</span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a><span class="co"># produce the two silhouette plots</span></span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>( <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) )</span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sil2, <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="fl">0.9</span>),</span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Spotify - K = 2"</span>)</span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sil3, <span class="at">col =</span> <span class="fu">adjustcolor</span>(col, <span class="fl">0.9</span>),</span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Spotify - K = 3"</span>)</span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a>Based on this analysis, the appropriate number of clusters is K=2 with K=3 being a close second. </span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a><span class="fu">## External Validation</span></span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a>External validation is used to compare the clustering results to a known partition of the data. </span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visually Comparing Clustering to Genre Classification</span></span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a>Now we compare the clustering obtained to the classification into genres, providing a brief interpretation of the clusters.</span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Two Cluster Solution</span></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a>Firstly we note that there are 3 genres, and hence using our obtained clustering with K=2 is not likely to capture the 3 genres entirely accurately. </span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a>The first figure below is a plot with symbol and colour corresponding to one of the three genres: rock, pop, and acoustic. The second figure is a plot with the symbol and colour corresponding to the two clusters.</span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a>If we flick between these two figures in the panels below, we can see that the orange and blue genres correspond to the orange cluster, and the purple genre corresponds to the blue cluster. This suggests that the orange and blue genres (<span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:orange;"</span><span class="kw">&gt;</span>rock<span class="kw">&lt;/span&gt;</span> and <span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:blue;"</span><span class="kw">&gt;</span>pop<span class="kw">&lt;/span&gt;</span>) have a great deal in common compared to the purple genre (<span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:purple;"</span><span class="kw">&gt;</span>acoustic<span class="kw">&lt;/span&gt;</span>).</span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three Genres</span></span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the genre</span></span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[spotify<span class="sc">$</span>genre],</span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[spotify<span class="sc">$</span>genre], <span class="fl">0.4</span>),</span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Actual Genres"</span>)</span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two Clusters</span></span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the cluster</span></span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit2<span class="sc">$</span>cluster],</span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit2<span class="sc">$</span>cluster], <span class="fl">0.4</span>),</span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 2"</span>)</span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Three Cluster Solution</span></span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>We also found that K=3 had the second highest CH value and an average silhouette value quite similar to K=2 (0.32 vs 0.39). As there are 3 genres, we can also plot these 3 clusters beside the 3 genres to see if this clustering compares better than the 2 clusters we previously used. </span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a>If we flick between these two plots, we can see that there is a relatively good separation between the three genres.</span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three Genres</span></span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the genre</span></span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[spotify<span class="sc">$</span>genre],</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[spotify<span class="sc">$</span>genre], <span class="fl">0.4</span>),</span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Actual Genres"</span>)</span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three Clusters</span></span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a><span class="co"># plot with symbol and color corresponding to the cluster</span></span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(numeric_spotify[,(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)], <span class="at">gap =</span> <span class="dv">0</span>, <span class="at">pch =</span> symb[fit3<span class="sc">$</span>cluster],</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">adjustcolor</span>(col[fit3<span class="sc">$</span>cluster], <span class="fl">0.4</span>),</span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Clustering result - K = 3"</span>)</span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rand Index</span></span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a>Instead of visually comparing the clusterings obtained to the classification into genres as we have up to now, we can also use the Rand and Adjusted Rand indices to compare our clustering solutions to the reference partition (the 3 genres) and see how well they agree (a socre of 1 represents strong agreement).</span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a>For our first table with the 3 clusters, we can see that the rock and pop genres are somewhat mixed and misidentified by clusters 1 and 2. However, we note that the acoustic genre is almost entirely correctly identified in cluster 2. The rand index in this case is 0.77 and the adjusted rand index is 0.5.</span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a><span class="co"># cross tabulation between the partitions -- K = 3</span></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a>tab1 <span class="ot">&lt;-</span> <span class="fu">table</span>(fit3<span class="sc">$</span>cluster, spotify<span class="sc">$</span>genre)</span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab1)</span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a><span class="fu">classAgreement</span>(tab1)</span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a>For the second table with the 2 clusters, we can see that the rock and pop genres are captured almost entirely accurately by cluster 1. The acoustic genre is captured fairly accurately by cluster 2. The rand index is 0.73 and the adjusted rand index is 0.47.</span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a><span class="co"># cross tabulation between the partitions -- K = 2</span></span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>tab2 <span class="ot">&lt;-</span> <span class="fu">table</span>(fit2<span class="sc">$</span>cluster, spotify<span class="sc">$</span>genre)</span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab2)</span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a><span class="fu">classAgreement</span>(tab2)</span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting the Clusters</span></span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a>Finally we will provide a brief interpretation of the clusters when K=2 (the optimal solution we identified in our analysis) </span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>**First Cluster**</span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>The first cluster corresponds to the rock and pop genres - suggesting that they are similar in a number of features. </span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a>**Second Cluster**</span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a>The second cluster captures the acoustic genre. As we noted from the silhouette plot when K=2, there is little ambiguity between these two clusters which suggests that the acoustic genre is greatly differentiated from the rock and pop genres. </span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>**A Note on the Three Cluster Solution**</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>We also note that when K=3, there is some confusion with clusters 1 and 2 misidentifying many of the songs in the rock and pop genres which suggests that they are not very clearly differentiated from each other compared to the acoustic genre. This aligns with our expectation that the rock and pop genres are more similar to each other than to the acoustic genre.</span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>